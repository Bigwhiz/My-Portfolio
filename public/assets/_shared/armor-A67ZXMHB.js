import{a as J}from"/assets/_shared/chunk-NHXO7TLZ.js";import{H as K,J as Q,K as S,L as Y,a as g,e as G,g as E,o as M,r as u,t as Z,u as k,v as j,x as W,y as D}from"/assets/_shared/chunk-L256IZSK.js";import{a as U}from"/assets/_shared/chunk-N6K2DFXZ.js";import{a as F}from"/assets/_shared/chunk-OAGHZG5J.js";import{b as q,c as I}from"/assets/_shared/chunk-3GAHIIES.js";import{d as L,e as v,f as C,g as z,j as H,k as V}from"/assets/_shared/chunk-F4ODTSJS.js";import{a as H0,b as y}from"/assets/_shared/chunk-ZSCARA4Z.js";import{c as _}from"/assets/_shared/chunk-F3TRQT5X.js";var e0="/assets/_assets/volkihar-cube-nx-MFIMTLYF.jpg";var t0="/assets/_assets/volkihar-cube-ny-6LBFMIGT.jpg";var n0="/assets/_assets/volkihar-cube-nz-BFG5BMZH.jpg";var p0="/assets/_assets/volkihar-cube-px-ZMAH6DUL.jpg";var a0="/assets/_assets/volkihar-cube-py-I3IS6N2S.jpg";var o0="/assets/_assets/volkihar-cube-pz-47DP52Y5.jpg";var r0="/assets/_assets/volkihar-knight-2YXUC67A.glb";var e=_(H0(),1);var f={armor:"bN7R0",loader:"JIDiX",canvas:"Jnb1A"};var P=_(y(),1),s0={stiffness:40,damping:20,mass:1.5},n1=({showDelay:i0=0,cameraPosition:$={x:0,y:0,z:6},className:P0,alt:m0,...x0})=>{let[R,B0]=(0,e.useState)(!1),[h0,D0]=(0,e.useState)(!1),[f0,$0]=(0,e.useState)(!1),m=(0,e.useRef)(),T=(0,e.useRef)(),x=(0,e.useRef)(),s=(0,e.useRef)(),a=(0,e.useRef)(),t=(0,e.useRef)(),l=(0,e.useRef)(),c=U(m,!1,{threshold:.4}),d=V(),O=H(0,s0),X=H(0,s0);(0,e.useEffect)(()=>{let{clientWidth:n,clientHeight:p}=m.current;t.current=new k({canvas:T.current,alpha:!0,antialias:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),t.current.setPixelRatio(2),t.current.setSize(n,p),t.current.outputColorSpace=G,t.current.toneMapping=g,x.current=new M(36,n/p,.1,100),x.current.position.set($.x,$.y,$.z),a.current=new j;let o=new W;s.current=new Z,a.current.add(s.current);let i=new u(t.current);i.compileCubemapShader();let h=new D(16777215,2.6),A=new D(16777215,1),w=new D(16777215,1.3);h.position.set(1,.1,2),A.position.set(-1,.1,8),w.position.set(-2,2,-3),l.current=[w,h,A],l.current.forEach(r=>a.current.add(r));let l0=async()=>{let r=K.loadAsync(r0),X0=o.loadAsync([e0,t0,n0,p0,a0,o0]),[b,b0]=await Promise.all([r,X0]);s.current.add(b.scene),b.scene.rotation.y=E.degToRad(180),b.scene.position.y=-1.6;let{texture:_0}=i.fromCubemap(b0);a.current.environment=_0,i.dispose(),await t.current.initTexture(a.current.environment),s.current.traverse(async N=>{N.material&&await t.current.initTexture(N.material)}),B0(!0),B()};(0,e.startTransition)(()=>{l0(),setTimeout(()=>{$0(!0)},1e3)});let c0=O.on("change",r=>{s.current.rotation.x=r,B()}),O0=X.on("change",r=>{s.current.rotation.y=r,B()});return()=>{Y(l.current),Q(a.current),S(t.current),c0(),O0()}},[]);let B=(0,e.useCallback)(()=>{t.current.render(a.current,x.current)},[]);return(0,e.useEffect)(()=>{let n=J(p=>{let{innerWidth:o,innerHeight:i}=window,h={x:(p.clientX-o/2)/o,y:(p.clientY-i/2)/i};O.set(h.y/2),X.set(h.x/2)},100);return c&&D0(!0),c&&!d&&window.addEventListener("mousemove",n),()=>{window.removeEventListener("mousemove",n)}},[c,d,O,X]),(0,e.useEffect)(()=>{let n=()=>{if(!m.current)return;let{clientWidth:p,clientHeight:o}=m.current;t.current.setSize(p,o),x.current.aspect=p/o,x.current.updateProjectionMatrix(),B()};return window.addEventListener("resize",n),n(),()=>{window.removeEventListener("resize",n)}},[B]),(0,P.jsxs)("div",{className:z(f.armor,P0),ref:m,role:"img","aria-label":m0,...x0,children:[(0,P.jsx)(I,{unmount:!0,in:!R&&f0,timeout:L(F.base.durationL),children:({visible:n})=>(0,P.jsx)(q,{className:f.loader,"data-visible":n})}),(0,P.jsx)("canvas",{className:f.canvas,ref:T,"data-loaded":R&&h0,style:C({delay:v(i0)})})]})};export{n1 as Armor};
